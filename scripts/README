This is from old shared Scripts - should pull out bits we need!
